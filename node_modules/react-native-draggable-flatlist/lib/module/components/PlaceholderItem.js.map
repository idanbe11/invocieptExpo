{"version":3,"names":["React","useMemo","useState","StyleSheet","Animated","runOnJS","useAnimatedReaction","useAnimatedStyle","useAnimatedValues","useDraggableFlatListContext","useRefs","typedMemo","PlaceholderItem","renderPlaceholder","size","setSize","activeCellSize","placeholderOffset","spacerIndexAnim","horizontalAnim","scrollOffset","keyToIndexRef","propsRef","activeKey","horizontal","value","cur","prev","activeIndex","current","get","undefined","activeItem","data","animStyle","offset","opacity","overflow","transform","translateX","translateY","extraStyle","width","height","absoluteFill","item","index"],"sources":["PlaceholderItem.tsx"],"sourcesContent":["import React, { useMemo, useState } from \"react\";\nimport { StyleSheet } from \"react-native\";\nimport Animated, {\n  runOnJS,\n  useAnimatedReaction,\n  useAnimatedStyle,\n} from \"react-native-reanimated\";\nimport { useAnimatedValues } from \"../context/animatedValueContext\";\nimport { useDraggableFlatListContext } from \"../context/draggableFlatListContext\";\nimport { useRefs } from \"../context/refContext\";\nimport { RenderPlaceholder } from \"../types\";\nimport { typedMemo } from \"../utils\";\n\ntype Props<T> = {\n  renderPlaceholder?: RenderPlaceholder<T>;\n};\n\nfunction PlaceholderItem<T>({ renderPlaceholder }: Props<T>) {\n  const [size, setSize] = useState(0);\n  const {\n    activeCellSize,\n    placeholderOffset,\n    spacerIndexAnim,\n    horizontalAnim,\n    scrollOffset,\n  } = useAnimatedValues();\n  const { keyToIndexRef, propsRef } = useRefs<T>();\n  const { activeKey, horizontal } = useDraggableFlatListContext();\n\n  // Size does not seem to be respected when it is an animated style\n  useAnimatedReaction(\n    () => {\n      return activeCellSize.value;\n    },\n    (cur, prev) => {\n      if (cur !== prev) {\n        runOnJS(setSize)(cur);\n      }\n    }\n  );\n\n  const activeIndex = activeKey\n    ? keyToIndexRef.current.get(activeKey)\n    : undefined;\n  const activeItem =\n    activeIndex === undefined ? null : propsRef.current?.data[activeIndex];\n\n  const animStyle = useAnimatedStyle(() => {\n    const offset = placeholderOffset.value - scrollOffset.value\n    return {\n        opacity: size >= 0 ? 1 : 0,\n        overflow: 'hidden',\n        transform: [\n          horizontalAnim.value\n            ? { translateX: offset }\n            : { translateY: offset },\n        ],\n      };\n\n  }, [spacerIndexAnim, placeholderOffset, horizontalAnim, scrollOffset, size]);\n\n  const extraStyle = useMemo(() => {\n    return horizontal ? { width: size } : { height: size };\n  }, [horizontal, size])\n\n  return (\n    <Animated.View\n      pointerEvents={activeKey ? \"auto\" : \"none\"}\n      style={[StyleSheet.absoluteFill, animStyle, extraStyle]}\n    >\n      {!activeItem || activeIndex === undefined\n        ? null\n        : renderPlaceholder?.({ item: activeItem, index: activeIndex })}\n    </Animated.View>\n  );\n}\n\nexport default typedMemo(PlaceholderItem);\n"],"mappings":"AAAA,OAAOA,KAAP,IAAgBC,OAAhB,EAAyBC,QAAzB,QAAyC,OAAzC;AACA,SAASC,UAAT,QAA2B,cAA3B;AACA,OAAOC,QAAP,IACEC,OADF,EAEEC,mBAFF,EAGEC,gBAHF,QAIO,yBAJP;AAKA,SAASC,iBAAT,QAAkC,iCAAlC;AACA,SAASC,2BAAT,QAA4C,qCAA5C;AACA,SAASC,OAAT,QAAwB,uBAAxB;AAEA,SAASC,SAAT,QAA0B,UAA1B;;AAMA,SAASC,eAAT,OAA6D;EAAA;;EAAA,IAAjC;IAAEC;EAAF,CAAiC;EAC3D,MAAM,CAACC,IAAD,EAAOC,OAAP,IAAkBb,QAAQ,CAAC,CAAD,CAAhC;EACA,MAAM;IACJc,cADI;IAEJC,iBAFI;IAGJC,eAHI;IAIJC,cAJI;IAKJC;EALI,IAMFZ,iBAAiB,EANrB;EAOA,MAAM;IAAEa,aAAF;IAAiBC;EAAjB,IAA8BZ,OAAO,EAA3C;EACA,MAAM;IAAEa,SAAF;IAAaC;EAAb,IAA4Bf,2BAA2B,EAA7D,CAV2D,CAY3D;;EACAH,mBAAmB,CACjB,MAAM;IACJ,OAAOU,cAAc,CAACS,KAAtB;EACD,CAHgB,EAIjB,CAACC,GAAD,EAAMC,IAAN,KAAe;IACb,IAAID,GAAG,KAAKC,IAAZ,EAAkB;MAChBtB,OAAO,CAACU,OAAD,CAAP,CAAiBW,GAAjB;IACD;EACF,CARgB,CAAnB;EAWA,MAAME,WAAW,GAAGL,SAAS,GACzBF,aAAa,CAACQ,OAAd,CAAsBC,GAAtB,CAA0BP,SAA1B,CADyB,GAEzBQ,SAFJ;EAGA,MAAMC,UAAU,GACdJ,WAAW,KAAKG,SAAhB,GAA4B,IAA5B,wBAAmCT,QAAQ,CAACO,OAA5C,sDAAmC,kBAAkBI,IAAlB,CAAuBL,WAAvB,CADrC;EAGA,MAAMM,SAAS,GAAG3B,gBAAgB,CAAC,MAAM;IACvC,MAAM4B,MAAM,GAAGlB,iBAAiB,CAACQ,KAAlB,GAA0BL,YAAY,CAACK,KAAtD;IACA,OAAO;MACHW,OAAO,EAAEtB,IAAI,IAAI,CAAR,GAAY,CAAZ,GAAgB,CADtB;MAEHuB,QAAQ,EAAE,QAFP;MAGHC,SAAS,EAAE,CACTnB,cAAc,CAACM,KAAf,GACI;QAAEc,UAAU,EAAEJ;MAAd,CADJ,GAEI;QAAEK,UAAU,EAAEL;MAAd,CAHK;IAHR,CAAP;EAUD,CAZiC,EAY/B,CAACjB,eAAD,EAAkBD,iBAAlB,EAAqCE,cAArC,EAAqDC,YAArD,EAAmEN,IAAnE,CAZ+B,CAAlC;EAcA,MAAM2B,UAAU,GAAGxC,OAAO,CAAC,MAAM;IAC/B,OAAOuB,UAAU,GAAG;MAAEkB,KAAK,EAAE5B;IAAT,CAAH,GAAqB;MAAE6B,MAAM,EAAE7B;IAAV,CAAtC;EACD,CAFyB,EAEvB,CAACU,UAAD,EAAaV,IAAb,CAFuB,CAA1B;EAIA,oBACE,oBAAC,QAAD,CAAU,IAAV;IACE,aAAa,EAAES,SAAS,GAAG,MAAH,GAAY,MADtC;IAEE,KAAK,EAAE,CAACpB,UAAU,CAACyC,YAAZ,EAA0BV,SAA1B,EAAqCO,UAArC;EAFT,GAIG,CAACT,UAAD,IAAeJ,WAAW,KAAKG,SAA/B,GACG,IADH,GAEGlB,iBAFH,aAEGA,iBAFH,uBAEGA,iBAAiB,CAAG;IAAEgC,IAAI,EAAEb,UAAR;IAAoBc,KAAK,EAAElB;EAA3B,CAAH,CANvB,CADF;AAUD;;AAED,eAAejB,SAAS,CAACC,eAAD,CAAxB"}