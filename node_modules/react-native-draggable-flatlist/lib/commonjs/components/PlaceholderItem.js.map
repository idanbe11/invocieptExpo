{"version":3,"names":["PlaceholderItem","renderPlaceholder","useState","size","setSize","useAnimatedValues","activeCellSize","placeholderOffset","spacerIndexAnim","horizontalAnim","scrollOffset","useRefs","keyToIndexRef","propsRef","useDraggableFlatListContext","activeKey","horizontal","useAnimatedReaction","value","cur","prev","runOnJS","activeIndex","current","get","undefined","activeItem","data","animStyle","useAnimatedStyle","offset","opacity","overflow","transform","translateX","translateY","extraStyle","useMemo","width","height","StyleSheet","absoluteFill","item","index","typedMemo"],"sources":["PlaceholderItem.tsx"],"sourcesContent":["import React, { useMemo, useState } from \"react\";\nimport { StyleSheet } from \"react-native\";\nimport Animated, {\n  runOnJS,\n  useAnimatedReaction,\n  useAnimatedStyle,\n} from \"react-native-reanimated\";\nimport { useAnimatedValues } from \"../context/animatedValueContext\";\nimport { useDraggableFlatListContext } from \"../context/draggableFlatListContext\";\nimport { useRefs } from \"../context/refContext\";\nimport { RenderPlaceholder } from \"../types\";\nimport { typedMemo } from \"../utils\";\n\ntype Props<T> = {\n  renderPlaceholder?: RenderPlaceholder<T>;\n};\n\nfunction PlaceholderItem<T>({ renderPlaceholder }: Props<T>) {\n  const [size, setSize] = useState(0);\n  const {\n    activeCellSize,\n    placeholderOffset,\n    spacerIndexAnim,\n    horizontalAnim,\n    scrollOffset,\n  } = useAnimatedValues();\n  const { keyToIndexRef, propsRef } = useRefs<T>();\n  const { activeKey, horizontal } = useDraggableFlatListContext();\n\n  // Size does not seem to be respected when it is an animated style\n  useAnimatedReaction(\n    () => {\n      return activeCellSize.value;\n    },\n    (cur, prev) => {\n      if (cur !== prev) {\n        runOnJS(setSize)(cur);\n      }\n    }\n  );\n\n  const activeIndex = activeKey\n    ? keyToIndexRef.current.get(activeKey)\n    : undefined;\n  const activeItem =\n    activeIndex === undefined ? null : propsRef.current?.data[activeIndex];\n\n  const animStyle = useAnimatedStyle(() => {\n    const offset = placeholderOffset.value - scrollOffset.value\n    return {\n        opacity: size >= 0 ? 1 : 0,\n        overflow: 'hidden',\n        transform: [\n          horizontalAnim.value\n            ? { translateX: offset }\n            : { translateY: offset },\n        ],\n      };\n\n  }, [spacerIndexAnim, placeholderOffset, horizontalAnim, scrollOffset, size]);\n\n  const extraStyle = useMemo(() => {\n    return horizontal ? { width: size } : { height: size };\n  }, [horizontal, size])\n\n  return (\n    <Animated.View\n      pointerEvents={activeKey ? \"auto\" : \"none\"}\n      style={[StyleSheet.absoluteFill, animStyle, extraStyle]}\n    >\n      {!activeItem || activeIndex === undefined\n        ? null\n        : renderPlaceholder?.({ item: activeItem, index: activeIndex })}\n    </Animated.View>\n  );\n}\n\nexport default typedMemo(PlaceholderItem);\n"],"mappings":"+PAAA,qDACA,yCACA,uFAKA,qEACA,6EACA,iDAEA,+B,mnCAMA,QAASA,gBAAT,MAA6D,0BAA/BC,kBAA+B,MAA/BA,iBAA+B,eACnC,GAAAC,eAAA,EAAS,CAAT,CADmC,qDACpDC,IADoD,eAC9CC,OAD8C,sCAQvD,GAAAC,uCAAA,GARuD,CAGzDC,cAHyD,oBAGzDA,cAHyD,CAIzDC,iBAJyD,oBAIzDA,iBAJyD,CAKzDC,eALyD,oBAKzDA,eALyD,CAMzDC,cANyD,oBAMzDA,cANyD,CAOzDC,YAPyD,oBAOzDA,YAPyD,cASvB,GAAAC,mBAAA,GATuB,CASnDC,aATmD,UASnDA,aATmD,CASpCC,QAToC,UASpCA,QAToC,2BAUzB,GAAAC,qDAAA,GAVyB,CAUnDC,SAVmD,uBAUnDA,SAVmD,CAUxCC,UAVwC,uBAUxCA,UAVwC,CAa3D,GAAAC,0CAAA,iCACQ,CACJ,MAAOX,eAAc,CAACY,KAAtB,CACD,CAHH,6BA5BOZ,cA4BP,4SAIGa,GAJH,CAIQC,IAJR,CAIiB,CACb,GAAID,GAAG,GAAKC,IAAZ,CAAkB,CAChB,GAAAC,8BAAA,EAAQjB,OAAR,EAAiBe,GAAjB,EACD,CACF,CARH,sBA3BEE,8BA2BF,SA3BUjB,OA2BV,kSAWA,GAAMkB,YAAW,CAAGP,SAAS,CACzBH,aAAa,CAACW,OAAd,CAAsBC,GAAtB,CAA0BT,SAA1B,CADyB,CAEzBU,SAFJ,CAGA,GAAMC,WAAU,CACdJ,WAAW,GAAKG,SAAhB,CAA4B,IAA5B,oBAAmCZ,QAAQ,CAACU,OAA5C,eAAmC,kBAAkBI,IAAlB,CAAuBL,WAAvB,CADrC,CAGA,GAAMM,UAAS,CAAG,GAAAC,uCAAA,iCAAuB,CACvC,GAAMC,OAAM,CAAGvB,iBAAiB,CAACW,KAAlB,CAA0BR,YAAY,CAACQ,KAAtD,CACA,MAAO,CACHa,OAAO,CAAE5B,IAAI,EAAI,CAAR,CAAY,CAAZ,CAAgB,CADtB,CAEH6B,QAAQ,CAAE,QAFP,CAGHC,SAAS,CAAE,CACTxB,cAAc,CAACS,KAAf,CACI,CAAEgB,UAAU,CAAEJ,MAAd,CADJ,CAEI,CAAEK,UAAU,CAAEL,MAAd,CAHK,CAHR,CAAP,CAUD,CAZiB,gCA7CHvB,iBA6CG,cA7CuBG,YA6CvB,MA3CPP,IA2CO,gBAzCJM,cAyCI,6dAYf,CAACD,eAAD,CAAkBD,iBAAlB,CAAqCE,cAArC,CAAqDC,YAArD,CAAmEP,IAAnE,CAZe,CAAlB,CAcA,GAAMiC,WAAU,CAAG,GAAAC,cAAA,EAAQ,UAAM,CAC/B,MAAOrB,WAAU,CAAG,CAAEsB,KAAK,CAAEnC,IAAT,CAAH,CAAqB,CAAEoC,MAAM,CAAEpC,IAAV,CAAtC,CACD,CAFkB,CAEhB,CAACa,UAAD,CAAab,IAAb,CAFgB,CAAnB,CAIA,MACE,8BAAC,8BAAD,CAAU,IAAV,EACE,aAAa,CAAEY,SAAS,CAAG,MAAH,CAAY,MADtC,CAEE,KAAK,CAAE,CAACyB,uBAAA,CAAWC,YAAZ,CAA0Bb,SAA1B,CAAqCQ,UAArC,CAFT,4EAIG,CAACV,UAAD,EAAeJ,WAAW,GAAKG,SAA/B,CACG,IADH,CAEGxB,iBAFH,cAEGA,iBAAiB,CAAG,CAAEyC,IAAI,CAAEhB,UAAR,CAAoBiB,KAAK,CAAErB,WAA3B,CAAH,CANvB,CADF,CAUD,C,aAEc,GAAAsB,gBAAA,EAAU5C,eAAV,C"}